use Pruebas

create table Salarios (
	id INT,
	first_name VARCHAR(50),
	last_name VARCHAR(50),
	Salario VARCHAR(50)
);
insert into Salarios (id, first_name, last_name, Salario) values (1, 'Tremaine', 'Gotcliffe', '€1796,46');
insert into Salarios (id, first_name, last_name, Salario) values (2, 'Ariella', 'Regler', '€4412,04');
insert into Salarios (id, first_name, last_name, Salario) values (3, 'Livia', 'Toye', '€4902,33');
insert into Salarios (id, first_name, last_name, Salario) values (4, 'Milli', 'Shawcroft', '€1150,64');
insert into Salarios (id, first_name, last_name, Salario) values (5, 'Devin', 'Wynes', '€3834,34');
insert into Salarios (id, first_name, last_name, Salario) values (6, 'Earle', 'Adamek', '€1477,08');
insert into Salarios (id, first_name, last_name, Salario) values (7, 'Eberhard', 'Kelledy', '€4999,88');
insert into Salarios (id, first_name, last_name, Salario) values (8, 'Fay', 'McNeely', '€2697,96');
insert into Salarios (id, first_name, last_name, Salario) values (9, 'Cull', 'Opfer', '€1884,69');
insert into Salarios (id, first_name, last_name, Salario) values (10, 'Ogden', 'Llop', '€3766,95');
insert into Salarios (id, first_name, last_name, Salario) values (11, 'Oberon', 'Garie', '€4367,63');
insert into Salarios (id, first_name, last_name, Salario) values (12, 'Caron', 'Lorait', '€4417,55');
insert into Salarios (id, first_name, last_name, Salario) values (13, 'Tammie', 'MacLoughlin', '€3831,50');
insert into Salarios (id, first_name, last_name, Salario) values (14, 'Aleta', 'Ivanchenkov', '€4327,65');
insert into Salarios (id, first_name, last_name, Salario) values (15, 'Gianna', 'Readitt', '€2459,35');
insert into Salarios (id, first_name, last_name, Salario) values (16, 'Vanda', 'Pottinger', '€1013,67');
insert into Salarios (id, first_name, last_name, Salario) values (17, 'Welch', 'McInulty', '€1096,86');
insert into Salarios (id, first_name, last_name, Salario) values (18, 'Rock', 'Greenrod', '€1276,13');
insert into Salarios (id, first_name, last_name, Salario) values (19, 'Imogene', 'Bumphries', '€4376,57');
insert into Salarios (id, first_name, last_name, Salario) values (20, 'Maurizia', 'Craister', '€1545,40');
insert into Salarios (id, first_name, last_name, Salario) values (21, 'Consalve', 'Quarrell', '€2916,85');
insert into Salarios (id, first_name, last_name, Salario) values (22, 'Sarette', 'Torbet', '€1101,15');
insert into Salarios (id, first_name, last_name, Salario) values (23, 'Erskine', 'Valenti', '€2272,90');
insert into Salarios (id, first_name, last_name, Salario) values (24, 'Jarrad', 'Cowlam', '€4018,97');
insert into Salarios (id, first_name, last_name, Salario) values (25, 'Fanchette', 'Causley', '€4246,40');
insert into Salarios (id, first_name, last_name, Salario) values (26, 'Leia', 'Dorow', '€3608,86');
insert into Salarios (id, first_name, last_name, Salario) values (27, 'Paola', 'Menary', '€3158,34');
insert into Salarios (id, first_name, last_name, Salario) values (28, 'Finn', 'Safell', '€2075,05');
insert into Salarios (id, first_name, last_name, Salario) values (29, 'Padgett', 'Sally', '€4061,09');
insert into Salarios (id, first_name, last_name, Salario) values (30, 'Livia', 'McIlreavy', '€1955,61');
insert into Salarios (id, first_name, last_name, Salario) values (31, 'Norene', 'Atcherley', '€2221,65');
insert into Salarios (id, first_name, last_name, Salario) values (32, 'Kellina', 'Prenty', '€1120,73');
insert into Salarios (id, first_name, last_name, Salario) values (33, 'Toddie', 'Albertson', '€1906,62');
insert into Salarios (id, first_name, last_name, Salario) values (34, 'Ginelle', 'Chell', '€3142,67');
insert into Salarios (id, first_name, last_name, Salario) values (35, 'Irwin', 'Primak', '€3553,44');
insert into Salarios (id, first_name, last_name, Salario) values (36, 'Clayson', 'Waylett', '€4567,13');
insert into Salarios (id, first_name, last_name, Salario) values (37, 'Elton', 'Porcas', '€3388,93');
insert into Salarios (id, first_name, last_name, Salario) values (38, 'Corney', 'Kubacek', '€4764,21');
insert into Salarios (id, first_name, last_name, Salario) values (39, 'Vittorio', 'MacDunlevy', '€1740,58');
insert into Salarios (id, first_name, last_name, Salario) values (40, 'Justine', 'Ballefant', '€1275,98');
insert into Salarios (id, first_name, last_name, Salario) values (41, 'Tybie', 'Cammiemile', '€4013,53');
insert into Salarios (id, first_name, last_name, Salario) values (42, 'Siffre', 'Sutherel', '€2339,12');
insert into Salarios (id, first_name, last_name, Salario) values (43, 'Elijah', 'Elletson', '€1680,73');
insert into Salarios (id, first_name, last_name, Salario) values (44, 'Hanson', 'Belfrage', '€2018,96');
insert into Salarios (id, first_name, last_name, Salario) values (45, 'Simeon', 'June', '€3084,52');
insert into Salarios (id, first_name, last_name, Salario) values (46, 'Elane', 'Abella', '€1869,30');
insert into Salarios (id, first_name, last_name, Salario) values (47, 'Bidget', 'Lundon', '€4443,62');
insert into Salarios (id, first_name, last_name, Salario) values (48, 'Rand', 'Arnold', '€3788,93');
insert into Salarios (id, first_name, last_name, Salario) values (49, 'Mischa', 'Dominec', '€4406,32');
insert into Salarios (id, first_name, last_name, Salario) values (50, 'Sumner', 'Laherty', '€3914,09');
insert into Salarios (id, first_name, last_name, Salario) values (51, 'Rubie', 'Barringer', '€4938,86');
insert into Salarios (id, first_name, last_name, Salario) values (52, 'Devonna', 'Whitfeld', '€2272,81');
insert into Salarios (id, first_name, last_name, Salario) values (53, 'Abeu', 'Jinkinson', '€1692,54');
insert into Salarios (id, first_name, last_name, Salario) values (54, 'Raimundo', 'Keeting', '€2003,69');
insert into Salarios (id, first_name, last_name, Salario) values (55, 'Charlton', 'Behan', '€1820,76');
insert into Salarios (id, first_name, last_name, Salario) values (56, 'Stevie', 'Derry', '€4912,33');
insert into Salarios (id, first_name, last_name, Salario) values (57, 'Kelly', 'Scolding', '€1839,61');
insert into Salarios (id, first_name, last_name, Salario) values (58, 'Wendye', 'Bondar', '€2792,18');
insert into Salarios (id, first_name, last_name, Salario) values (59, 'Hashim', 'Aseef', '€1437,79');
insert into Salarios (id, first_name, last_name, Salario) values (60, 'Hurlee', 'Raulstone', '€2095,92');
insert into Salarios (id, first_name, last_name, Salario) values (61, 'Sari', 'Mains', '€2072,36');
insert into Salarios (id, first_name, last_name, Salario) values (62, 'Moselle', 'Litton', '€4671,94');
insert into Salarios (id, first_name, last_name, Salario) values (63, 'Gregoor', 'Spiller', '€3251,37');
insert into Salarios (id, first_name, last_name, Salario) values (64, 'Loren', 'Gimson', '€2643,95');
insert into Salarios (id, first_name, last_name, Salario) values (65, 'Kip', 'Neeson', '€3780,61');
insert into Salarios (id, first_name, last_name, Salario) values (66, 'Jessi', 'Collinwood', '€4838,41');
insert into Salarios (id, first_name, last_name, Salario) values (67, 'Arlyne', 'Murtell', '€2179,92');
insert into Salarios (id, first_name, last_name, Salario) values (68, 'Lutero', 'Matschoss', '€2576,13');
insert into Salarios (id, first_name, last_name, Salario) values (69, 'Lilla', 'Francescoccio', '€4891,31');
insert into Salarios (id, first_name, last_name, Salario) values (70, 'Johnna', 'Ledger', '€1737,60');
insert into Salarios (id, first_name, last_name, Salario) values (71, 'Ange', 'Crippen', '€3429,05');
insert into Salarios (id, first_name, last_name, Salario) values (72, 'Jocelyn', 'Phuprate', '€1032,33');
insert into Salarios (id, first_name, last_name, Salario) values (73, 'Pietrek', 'Snawdon', '€2582,98');
insert into Salarios (id, first_name, last_name, Salario) values (74, 'Emelyne', 'Mabson', '€3971,11');
insert into Salarios (id, first_name, last_name, Salario) values (75, 'Mallorie', 'Cuncarr', '€3178,75');
insert into Salarios (id, first_name, last_name, Salario) values (76, 'Elisa', 'Loxly', '€1391,39');
insert into Salarios (id, first_name, last_name, Salario) values (77, 'Kerwinn', 'Slisby', '€3254,91');
insert into Salarios (id, first_name, last_name, Salario) values (78, 'Tressa', 'Ibbott', '€3271,20');
insert into Salarios (id, first_name, last_name, Salario) values (79, 'Hilario', 'Faier', '€2934,00');
insert into Salarios (id, first_name, last_name, Salario) values (80, 'Fanni', 'Course', '€3335,69');
insert into Salarios (id, first_name, last_name, Salario) values (81, 'Ellery', 'Pallasch', '€1267,29');
insert into Salarios (id, first_name, last_name, Salario) values (82, 'Linda', 'Oxshott', '€1448,99');
insert into Salarios (id, first_name, last_name, Salario) values (83, 'Pearce', 'Hansman', '€4823,24');
insert into Salarios (id, first_name, last_name, Salario) values (84, 'Dominic', 'Lugg', '€1648,01');
insert into Salarios (id, first_name, last_name, Salario) values (85, 'Leigha', 'Keppin', '€2199,86');
insert into Salarios (id, first_name, last_name, Salario) values (86, 'Roxana', 'Pote', '€4696,05');
insert into Salarios (id, first_name, last_name, Salario) values (87, 'Isaak', 'Gubbin', '€4757,29');
insert into Salarios (id, first_name, last_name, Salario) values (88, 'Melonie', 'Carnaman', '€3265,01');
insert into Salarios (id, first_name, last_name, Salario) values (89, 'Fanechka', 'Pughsley', '€3085,72');
insert into Salarios (id, first_name, last_name, Salario) values (90, 'Jakie', 'Jellico', '€4077,58');
insert into Salarios (id, first_name, last_name, Salario) values (91, 'Siusan', 'Roxburgh', '€4992,86');
insert into Salarios (id, first_name, last_name, Salario) values (92, 'Lulita', 'Rivard', '€1101,43');
insert into Salarios (id, first_name, last_name, Salario) values (93, 'Carmine', 'Assante', '€1834,58');
insert into Salarios (id, first_name, last_name, Salario) values (94, 'Julie', 'Killcross', '€2658,00');
insert into Salarios (id, first_name, last_name, Salario) values (95, 'Emanuele', 'Kainz', '€4306,15');
insert into Salarios (id, first_name, last_name, Salario) values (96, 'Vi', 'Luberti', '€4407,08');
insert into Salarios (id, first_name, last_name, Salario) values (97, 'Englebert', 'Fulks', '€1020,39');
insert into Salarios (id, first_name, last_name, Salario) values (98, 'Sarette', 'Denzey', '€1905,18');
insert into Salarios (id, first_name, last_name, Salario) values (99, 'Jasmin', 'Robe', '€1053,44');
insert into Salarios (id, first_name, last_name, Salario) values (100, 'Nikaniki', 'Standring', '€1720,11');

-------------------------
-------------------------
select * from Salarios
order by Salario desc
offset 1 rows
fetch next 1 rows only
-----------otra forma
select Salario from Salarios
where salario in (select Salario
from Salarios
order by Salario desc
offset 1 rows
fetch next 1 rows only)
order by Salario desc
--------------------------------
-------------------------------
--Rank
Select Salario,rank() over (order by Salario desc) as Rank
from Salarios


--trabajador que gana mas que su manager

create table Manager (
	id INT,
	Name VARCHAR(50),
	Salario VARCHAR(50),
	ManagerID INT
);
insert into Manager (id, Name, Salario, ManagerID) values (1, 'Theda', '€8654,02', 1);
insert into Manager (id, Name, Salario, ManagerID) values (2, 'Trista', '€4248,11', 2);
insert into Manager (id, Name, Salario, ManagerID) values (3, 'Dulcy', '€9630,72', 3);
insert into Manager (id, Name, Salario, ManagerID) values (4, 'Wat', '€7829,65', 4);
insert into Manager (id, Name, Salario, ManagerID) values (5, 'Hali', '€9979,07', 5);
insert into Manager (id, Name, Salario, ManagerID) values (6, 'Arnie', '€5968,22', 6);
insert into Manager (id, Name, Salario, ManagerID) values (7, 'Baxter', '€1423,52', 7);
insert into Manager (id, Name, Salario, ManagerID) values (8, 'Korey', '€1705,57', 8);
insert into Manager (id, Name, Salario, ManagerID) values (9, 'Sayers', '€4631,19', 9);
insert into Manager (id, Name, Salario, ManagerID) values (10, 'Wang', '€9004,41', 10);
insert into Manager (id, Name, Salario, ManagerID) values (11, 'Olympie', '€6544,10', 11);
insert into Manager (id, Name, Salario, ManagerID) values (12, 'Brigham', '€9364,76', 12);
insert into Manager (id, Name, Salario, ManagerID) values (13, 'Kelila', '€2007,44', 13);
insert into Manager (id, Name, Salario, ManagerID) values (14, 'Pat', '€4654,44', 14);
insert into Manager (id, Name, Salario, ManagerID) values (15, 'Melany', '€1355,42', 15);
insert into Manager (id, Name, Salario, ManagerID) values (16, 'Nehemiah', '€8173,27', 16);
insert into Manager (id, Name, Salario, ManagerID) values (17, 'Neill', '€7931,92', 17);
insert into Manager (id, Name, Salario, ManagerID) values (18, 'Verene', '€7703,51', 18);
insert into Manager (id, Name, Salario, ManagerID) values (19, 'Lorens', '€6492,95', 19);
insert into Manager (id, Name, Salario, ManagerID) values (20, 'Isaiah', '€9921,82', 20);
insert into Manager (id, Name, Salario, ManagerID) values (21, 'Philis', '€5336,70', 21);
insert into Manager (id, Name, Salario, ManagerID) values (22, 'Baryram', '€7762,17', 22);
insert into Manager (id, Name, Salario, ManagerID) values (23, 'Zandra', '€8539,79', 23);
insert into Manager (id, Name, Salario, ManagerID) values (24, 'Vladamir', '€8317,31', 24);
insert into Manager (id, Name, Salario, ManagerID) values (25, 'Catie', '€7028,27', 25);
insert into Manager (id, Name, Salario, ManagerID) values (26, 'Brigg', '€1216,53', 26);


----------
---------

select * from Manager
select * from Salarios

select top(1) s.first_name
from Salarios as s
inner join Manager as m
on s.id=m.ManagerID
where s.Salario>m.Salario